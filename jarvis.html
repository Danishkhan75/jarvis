<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jarvis AI v6.0 - Ultra Advanced by AmmiAbbu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #2d1b4e 100%); font-family: 'Segoe UI', sans-serif; color: #e2e8f0; min-height: 100vh; overflow-x: hidden; }
    .gradient-text { background: linear-gradient(135deg, #00d4ff, #7c3aed, #ff006e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: bold; animation: gradientShift 3s ease infinite; }
    @keyframes gradientShift { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
    .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(30px); border: 1px solid rgba(148, 163, 184, 0.15); border-radius: 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }
    .input-box { background: rgba(30, 41, 59, 0.6); border: 2px solid rgba(148, 163, 184, 0.2); border-radius: 12px; padding: 14px 18px; color: #e2e8f0; width: 100%; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); font-size: 15px; }
    .input-box:focus { outline: none; border-color: #00d4ff; box-shadow: 0 0 30px rgba(0, 212, 255, 0.4); background: rgba(30, 41, 59, 0.8); transform: translateY(-2px); }
    .btn-primary { background: linear-gradient(135deg, #00d4ff, #7c3aed); color: white; padding: 12px 24px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 4px 15px rgba(0, 212, 255, 0.3); position: relative; overflow: hidden; }
    .btn-primary:before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); transition: 0.5s; }
    .btn-primary:hover:before { left: 100%; }
    .btn-primary:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5); }
    .btn-primary:active { transform: translateY(-1px) scale(0.98); }
    .btn-secondary { background: rgba(100, 116, 139, 0.5); color: white; padding: 10px 20px; border: none; border-radius: 10px; cursor: pointer; transition: all 0.3s; }
    .btn-secondary:hover { background: rgba(100, 116, 139, 0.8); transform: translateY(-2px); }
    .chat-msg { padding: 15px; border-radius: 12px; margin: 10px 0; animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .user-msg { background: linear-gradient(135deg, #00d4ff, #0099cc); margin-left: auto; max-width: 75%; }
    .ai-msg { background: rgba(30, 41, 59, 0.9); border: 1px solid rgba(0, 212, 255, 0.3); margin-right: auto; max-width: 75%; box-shadow: 0 0 20px rgba(0, 212, 255, 0.1); }
    .sys-msg { background: rgba(124, 58, 237, 0.3); max-width: 85%; margin: 0 auto; text-align: center; font-size: 13px; border: 1px solid rgba(124, 58, 237, 0.4); }
    .sidebar { position: fixed; left: 0; top: 0; width: 280px; height: 100vh; background: rgba(10, 14, 39, 0.95); border-right: 1px solid rgba(148, 163, 184, 0.1); padding: 30px 20px; overflow-y: auto; z-index: 100; box-shadow: 5px 0 20px rgba(0, 0, 0, 0.3); }
    .main-content { margin-left: 280px; padding: 30px; min-height: 100vh; }
    .nav-item { padding: 15px 20px; margin: 12px 0; border-radius: 12px; cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-left: 4px solid transparent; display: flex; align-items: center; gap: 12px; font-size: 15px; }
    .nav-item:hover { background: rgba(0, 212, 255, 0.15); border-left-color: #00d4ff; transform: translateX(5px); }
    .nav-item.active { background: rgba(0, 212, 255, 0.25); border-left-color: #00d4ff; box-shadow: 0 0 20px rgba(0, 212, 255, 0.2); }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
    .modal.active { display: flex; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content { background: linear-gradient(135deg, #0f172a, #1e293b); padding: 40px; border-radius: 20px; max-width: 600px; width: 90%; border: 1px solid rgba(148, 163, 184, 0.2); animation: scaleIn 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); }
    @keyframes scaleIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(0, 212, 255, 0.2); border-top-color: #00d4ff; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .stat-card { background: rgba(30, 41, 59, 0.7); border: 1px solid rgba(0, 212, 255, 0.2); padding: 20px; border-radius: 15px; text-align: center; transition: all 0.3s; }
    .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2); border-color: #00d4ff; }
    .stat-value { font-size: 28px; font-weight: bold; color: #00d4ff; }
    .stat-label { font-size: 13px; color: #94a3b8; margin-top: 8px; }
    .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
    .particle { position: absolute; width: 4px; height: 4px; background: rgba(0, 212, 255, 0.6); border-radius: 50%; animation: float 8s infinite ease-in-out; }
    @keyframes float { 0%, 100% { transform: translateY(0) translateX(0); opacity: 0.8; } 50% { transform: translateY(-100px) translateX(50px); opacity: 0.3; } }
    .login-container { display: flex; align-items: center; justify-content: center; min-height: 100vh; position: relative; z-index: 1; }
    .login-box { animation: loginAppear 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
    @keyframes loginAppear { from { opacity: 0; transform: translateY(30px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    .creator-badge { display: inline-block; background: linear-gradient(135deg, #7c3aed, #ff006e); padding: 6px 16px; border-radius: 20px; font-size: 12px; font-weight: bold; margin-top: 10px; box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4); }
    @media (max-width: 768px) { .sidebar { width: 100%; height: auto; position: relative; } .main-content { margin-left: 0; padding: 20px; } }
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  <div id="app"></div>

  <script>
    // Particle background
    function createParticles() {
      const container = document.getElementById('particles');
      for (let i = 0; i < 30; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 5 + 's';
        particle.style.animationDuration = (5 + Math.random() * 5) + 's';
        container.appendChild(particle);
      }
    }
    createParticles();

    const API = "http://127.0.0.1:8000";
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = SpeechRecognition ? new SpeechRecognition() : null;
    
    if (recognition) {
      recognition.continuous = true;
      recognition.interimResults = false;
      recognition.lang = 'en-US';
    }

    // Simulated user database (in production, use real authentication)
    const USERS = {
      "admin": "admin123",
      "jarvis": "jarvis2024",
      "user": "password"
    };

    let state = {
      page: "login",
      user: null,
      messages: [],
      systemStats: {cpu: {percent: 0}, memory: {percent: 0}, disk: {percent: 0}},
      isListening: false,
      connected: false,
      activeTasks: 0,
      sessionId: Date.now(),
      loggingIn: false
    };

    // Load session from memory (not localStorage)
    function loadSession() {
      // Session persists only during page lifetime
      if (state.user) {
        return true;
      }
      return false;
    }

    function saveSession() {
      // Session is maintained in memory only
      console.log('Session active for:', state.user);
    }

    async function checkBackend() {
      try {
        const res = await fetch(`${API}/health`);
        if (res.ok) {
          const data = await res.json();
          state.connected = true;
          state.systemStats = data.system || {cpu: {percent: 0}, memory: {percent: 0}, disk: {percent: 0}};
          // Only render if user is logged in (not on login page)
          if (state.user) {
            render();
          }
        }
      } catch (e) {
        state.connected = false;
        console.error("Backend offline:", e);
        // Only render if user is logged in (not on login page)
        if (state.user) {
          render();
        }
      }
    }

    async function sendMessage(text) {
      if (!text || !text.trim()) return;
      
      const messageText = text.trim();
      addMessage("You", messageText, "user");
      render();

      try {
        const res = await fetch(`${API}/chat`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: messageText, user: state.user })
        });
        const data = await res.json();
        if (data.error) {
          addMessage("System", "Error: " + data.response, "system");
        } else {
          addMessage("Jarvis", data.response, "ai");
          speak(data.response.substring(0, 100));
        }
      } catch (e) {
        addMessage("System", "Connection error: " + e.message, "system");
      }
      render();
    }

    function speak(text) {
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.rate = 1.2;
        utterance.pitch = 1;
        window.speechSynthesis.speak(utterance);
      }
    }

    function toggleMic() {
      if (!recognition) {
        addMessage("System", "Speech recognition not supported in this browser", "system");
        render();
        return;
      }
      if (state.isListening) {
        recognition.stop();
      } else {
        recognition.start();
      }
    }

    if (recognition) {
      recognition.onstart = () => { 
        state.isListening = true; 
        console.log('Listening started');
        render(); 
      };
      recognition.onend = () => { 
        state.isListening = false; 
        console.log('Listening ended');
        render(); 
      };
      recognition.onresult = (event) => {
        for (let i = event.resultIndex; i < event.results.length; i++) {
          if (event.results[i].isFinal) {
            const transcript = event.results[i][0].transcript.trim();
            processVoiceCommand(transcript);
          }
        }
      };
      recognition.onerror = (event) => {
        console.error('Speech recognition error:', event.error);
        state.isListening = false;
        render();
      };
    }

    async function processVoiceCommand(text) {
      addMessage("You (Voice)", text, "user");
      await sendMessage(text);
    }

    function addMessage(sender, text, type) {
      state.messages.push({ 
        sender, 
        text, 
        type, 
        time: new Date().toLocaleTimeString(),
        id: Date.now() + Math.random()
      });
      if (state.messages.length > 200) state.messages.shift();
      
      // Auto-scroll to bottom
      setTimeout(() => {
        const chatContainer = document.getElementById('chatMessages');
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
        }
      }, 100);
    }

    function login(username, password) {
      // Prevent multiple rapid calls
      if (state.loggingIn) return;
      
      if (!username || !password) {
        alert('Please enter both username and password');
        return;
      }

      state.loggingIn = true;
      
      if (USERS[username] && USERS[username] === password) {
        state.user = username;
        state.page = 'dashboard';
        saveSession();
        addMessage("System", `Welcome back, ${username}! ðŸŽ‰`, "system");
        state.loggingIn = false;
        render();
      } else {
        alert('Invalid credentials! Try: admin/admin123 or jarvis/jarvis2024');
        state.loggingIn = false;
      }
    }

    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        state.user = null;
        state.page = 'login';
        state.messages = [];
        state.sessionId = Date.now();
        render();
      }
    }

    function changePage(page) {
      state.page = page;
      render();
    }

    function render() {
      const root = document.getElementById('app');
      
      if (!state.user) {
        root.innerHTML = `
          <div class="login-container">
            <div class="glass p-12 max-w-md w-full mx-4 login-box">
              <div class="text-center mb-8">
                <h1 class="text-7xl font-bold mb-4">
                  <i class="fas fa-robot gradient-text"></i>
                </h1>
                <h2 class="text-5xl font-bold gradient-text mb-2">JARVIS AI</h2>
                <p class="text-gray-400 text-lg mb-2">Ultra Advanced Intelligence v6.0</p>
                <div class="creator-badge">Created by AmmiAbbu</div>
              </div>
              
              <div class="mb-6">
                <p class="text-sm text-gray-400 text-center mb-4">
                  ${state.connected ? 
                    '<i class="fas fa-check-circle text-green-400"></i> Backend Online' : 
                    '<i class="fas fa-exclamation-circle text-red-400"></i> Connecting...'}
                </p>
              </div>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm text-gray-400 mb-2">Username</label>
                  <input 
                    type="text" 
                    id="loginUsername" 
                    placeholder="Enter username" 
                    class="input-box" 
                    onkeydown="if(event.key==='Enter') { event.preventDefault(); document.getElementById('loginPassword').focus(); }"
                    autocomplete="username"
                  />
                </div>
                
                <div>
                  <label class="block text-sm text-gray-400 mb-2">Password</label>
                  <input 
                    type="password" 
                    id="loginPassword" 
                    placeholder="Enter password" 
                    class="input-box"
                    onkeydown="if(event.key==='Enter') { event.preventDefault(); login(document.getElementById('loginUsername').value, document.getElementById('loginPassword').value); }"
                    autocomplete="current-password"
                  />
                </div>

                <button 
                  onclick="login(document.getElementById('loginUsername').value, document.getElementById('loginPassword').value)" 
                  class="btn-primary w-full py-4 text-lg"
                >
                  <i class="fas fa-sign-in-alt mr-2"></i> Login to System
                </button>
              </div>

              <div class="mt-6 text-center text-xs text-gray-500">
                <p class="mb-2">Demo Credentials:</p>
                <p>admin / admin123</p>
                <p>jarvis / jarvis2024</p>
              </div>
            </div>
          </div>
        `;
      } else {
        root.innerHTML = `
          <div class="flex">
            <div class="sidebar">
              <div class="gradient-text text-3xl font-bold mb-2">JARVIS</div>
              <p class="text-xs text-gray-500 mb-8">by AmmiAbbu</p>
              
              <div class="nav-item ${state.page === 'dashboard' ? 'active' : ''}" onclick="changePage('dashboard')">
                <i class="fas fa-home"></i> Dashboard
              </div>
              <div class="nav-item ${state.page === 'chat' ? 'active' : ''}" onclick="changePage('chat')">
                <i class="fas fa-comments"></i> Chat
              </div>
              <div class="nav-item ${state.page === 'tools' ? 'active' : ''}" onclick="changePage('tools')">
                <i class="fas fa-tools"></i> Tools
              </div>
              
              <div class="mt-auto pt-8">
                <div class="nav-item" onclick="logout()">
                  <i class="fas fa-power-off"></i> Logout
                </div>
              </div>
              
              <div class="mt-6 p-4 bg-slate-900 bg-opacity-50 rounded-lg text-xs">
                <p class="text-gray-400">Logged in as:</p>
                <p class="text-blue-400 font-bold">${state.user}</p>
              </div>
            </div>

            <div class="main-content w-full">
              ${state.page === 'dashboard' ? renderDashboard() : ''}
              ${state.page === 'chat' ? renderChat() : ''}
              ${state.page === 'tools' ? renderTools() : ''}
            </div>
          </div>
        `;
      }
    }

    function renderDashboard() {
      return `
        <div>
          <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
            <div>
              <h1 class="text-5xl font-bold gradient-text mb-2">Welcome, ${state.user}</h1>
              <p class="text-gray-400">Your AI Assistant is ready</p>
            </div>
            <button onclick="toggleMic()" class="btn-primary ${state.isListening ? 'bg-red-600' : ''}">
              <i class="fas fa-microphone mr-2"></i> ${state.isListening ? 'Listening...' : 'Voice Command'}
            </button>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="stat-card">
              <div class="stat-value">${state.systemStats.cpu?.percent?.toFixed(1) || '0.0'}%</div>
              <div class="stat-label"><i class="fas fa-microchip mr-1"></i> CPU Usage</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${state.systemStats.memory?.percent?.toFixed(1) || '0.0'}%</div>
              <div class="stat-label"><i class="fas fa-memory mr-1"></i> Memory</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${state.systemStats.disk?.percent?.toFixed(1) || '0.0'}%</div>
              <div class="stat-label"><i class="fas fa-hdd mr-1"></i> Disk</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${state.messages.length}</div>
              <div class="stat-label"><i class="fas fa-comments mr-1"></i> Messages</div>
            </div>
          </div>

          <div class="glass p-8 mb-8">
            <h2 class="text-3xl font-bold gradient-text mb-6">Quick Actions</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <button onclick="changePage('chat')" class="btn-primary py-6">
                <i class="fas fa-comments text-2xl mb-2"></i><br>Start Chat
              </button>
              <button onclick="changePage('tools')" class="btn-primary py-6">
                <i class="fas fa-tools text-2xl mb-2"></i><br>Tools
              </button>
              <button onclick="toggleMic()" class="btn-primary py-6">
                <i class="fas fa-microphone text-2xl mb-2"></i><br>Voice
              </button>
              <button onclick="checkBackend()" class="btn-primary py-6">
                <i class="fas fa-sync text-2xl mb-2"></i><br>Refresh
              </button>
            </div>
          </div>

          <div class="glass p-8">
            <h2 class="text-2xl font-bold gradient-text mb-4">Recent Activity</h2>
            <div class="space-y-3 max-h-80 overflow-y-auto">
              ${state.messages.slice(-10).reverse().map(m => `
                <div class="p-4 bg-slate-900 bg-opacity-60 rounded-lg border-l-4 border-blue-500">
                  <div class="flex justify-between items-start mb-1">
                    <span class="text-blue-300 font-bold text-sm">${m.sender}</span>
                    <span class="text-gray-500 text-xs">${m.time}</span>
                  </div>
                  <p class="text-sm text-gray-300">${m.text.substring(0, 100)}${m.text.length > 100 ? '...' : ''}</p>
                </div>
              `).join('') || '<p class="text-gray-500 text-center py-8">No recent activity</p>'}
            </div>
          </div>
        </div>
      `;
    }

    function renderChat() {
      return `
        <div>
          <h1 class="text-4xl font-bold gradient-text mb-6">
            <i class="fas fa-comments mr-3"></i> Chat with Jarvis
          </h1>
          <div class="glass p-6">
            <div id="chatMessages" class="space-y-4 max-h-[500px] overflow-y-auto mb-6 bg-slate-900 bg-opacity-30 p-6 rounded-xl">
              ${state.messages.length === 0 ? `
                <div class="text-center py-12">
                  <i class="fas fa-robot text-6xl text-blue-400 mb-4"></i>
                  <p class="text-gray-400 text-lg">Start a conversation with Jarvis</p>
                </div>
              ` : ''}
              ${state.messages.map(m => `
                <div class="flex ${m.type === 'user' ? 'justify-end' : 'justify-start'}">
                  <div class="chat-msg ${m.type === 'user' ? 'user-msg' : m.type === 'ai' ? 'ai-msg' : 'sys-msg'}">
                    <p class="text-xs font-bold mb-1 opacity-80">${m.sender}</p>
                    <p class="text-sm leading-relaxed">${m.text}</p>
                    <p class="text-xs opacity-60 mt-2">${m.time}</p>
                  </div>
                </div>
              `).join('')}
            </div>
            <div class="flex gap-3">
              <input 
                type="text" 
                id="chatInput" 
                placeholder="Type your message..." 
                class="input-box flex-1" 
                onkeypress="if(event.key==='Enter') { const inp = document.getElementById('chatInput'); sendMessage(inp.value); inp.value = ''; }"
              />
              <button 
                onclick="const inp = document.getElementById('chatInput'); sendMessage(inp.value); inp.value = '';" 
                class="btn-primary px-8"
              >
                <i class="fas fa-paper-plane"></i>
              </button>
              <button 
                onclick="toggleMic()" 
                class="btn-primary ${state.isListening ? 'bg-red-600' : ''} px-8"
              >
                <i class="fas fa-microphone"></i>
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function renderTools() {
      return `
        <div>
          <h1 class="text-4xl font-bold gradient-text mb-6">
            <i class="fas fa-tools mr-3"></i> Tools & Utilities
          </h1>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="glass p-6">
              <h2 class="text-2xl font-bold gradient-text mb-4">
                <i class="fas fa-search mr-2"></i> Web Search
              </h2>
              <input type="text" id="searchQuery" placeholder="Search anything..." class="input-box mb-4" />
              <button onclick="sendMessage('search: ' + document.getElementById('searchQuery').value)" class="btn-primary w-full">
                <i class="fas fa-search mr-2"></i> Search
              </button>
            </div>

            <div class="glass p-6">
              <h2 class="text-2xl font-bold gradient-text mb-4">
                <i class="fas fa-cloud mr-2"></i> Weather
              </h2>
              <input type="text" id="weatherCity" placeholder="Enter city name..." class="input-box mb-4" />
              <button onclick="sendMessage('weather in ' + document.getElementById('weatherCity').value)" class="btn-primary w-full">
                <i class="fas fa-cloud-sun mr-2"></i> Get Weather
              </button>
            </div>

            <div class="glass p-6">
              <h2 class="text-2xl font-bold gradient-text mb-4">
                <i class="fas fa-calculator mr-2"></i> Quick Math
              </h2>
              <input type="text" id="mathQuery" placeholder="e.g., 25 * 48 + 100" class="input-box mb-4" />
              <button onclick="sendMessage('calculate: ' + document.getElementById('mathQuery').value)" class="btn-primary w-full">
                <i class="fas fa-calculator mr-2"></i> Calculate
              </button>
            </div>

            <div class="glass p-6">
              <h2 class="text-2xl font-bold gradient-text mb-4">
                <i class="fas fa-info-circle mr-2"></i> System Status
              </h2>
              <div class="space-y-2 text-sm">
                <p><i class="fas fa-microchip text-blue-400 mr-2"></i> CPU: ${state.systemStats.cpu?.percent?.toFixed(1) || '0'}%</p>
                <p><i class="fas fa-memory text-purple-400 mr-2"></i> Memory: ${state.systemStats.memory?.percent?.toFixed(1) || '0'}%</p>
                <p><i class="fas fa-hdd text-green-400 mr-2"></i> Disk: ${state.systemStats.disk?.percent?.toFixed(1) || '0'}%</p>
                <p><i class="fas fa-wifi text-cyan-400 mr-2"></i> Status: ${state.connected ? 'Connected' : 'Offline'}</p>
              </div>
              <button onclick="checkBackend()" class="btn-primary w-full mt-4">
                <i class="fas fa-sync mr-2"></i> Refresh Stats
              </button>
            </div>
          </div>
        </div>
      `;
    }

    // Initialize
    loadSession();
    checkBackend();
    // Only auto-refresh backend status when user is logged in
    setInterval(() => {
      if (state.user) {
        checkBackend();
      }
    }, 5000);
    render();
  </script>
</body>
</html> -->






 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jarvis AI v10.0 - Ultra Advanced Edition</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root{
      --primary:#00d4ff;
      --secondary:#7c3aed;
      --accent:#ff006e;
      --success:#10b981;
      --warning:#f59e0b;
      --danger:#ef4444;
      --bg-dark:#0a0e27;
      --glass:rgba(15,23,42,0.92);
      --text:#e2e8f0;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      background:linear-gradient(135deg,var(--bg-dark) 0%,#1a1f3a 50%,#2d1b4e 100%);
      font-family:'Segoe UI',system-ui,-apple-system,sans-serif;
      color:var(--text);
      min-height:100vh;
      overflow-x:hidden;
      position:relative;
    }
    
    .particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden}
    .particle{
      position:absolute;width:4px;height:4px;background:rgba(0,212,255,0.9);border-radius:50%;
      animation:ultraFloat 12s infinite ease-in-out;box-shadow:0 0 20px rgba(0,212,255,0.7);
    }
    @keyframes ultraFloat{
      0%{transform:translate(0,0) rotate(0deg) scale(1);opacity:1}
      25%{transform:translate(100px,-150px) rotate(90deg) scale(1.3);opacity:0.7}
      50%{transform:translate(-80px,-250px) rotate(180deg) scale(0.9);opacity:0.4}
      75%{transform:translate(120px,-180px) rotate(270deg) scale(1.2);opacity:0.8}
      100%{transform:translate(0,0) rotate(360deg) scale(1);opacity:1}
    }
    
    .glass{
      background:var(--glass);backdrop-filter:blur(35px) saturate(200%);
      -webkit-backdrop-filter:blur(35px) saturate(200%);
      border:1px solid rgba(148,163,184,0.2);border-radius:28px;
      box-shadow:0 12px 40px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.15);
      padding:45px;position:relative;overflow:hidden;
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
    }
    .glass:hover{
      transform:translateY(-5px);
      box-shadow:0 20px 60px rgba(0,212,255,0.3),inset 0 1px 0 rgba(255,255,255,0.2);
    }
    .glass::before{
      content:'';position:absolute;top:0;left:0;right:0;height:4px;
      background:linear-gradient(90deg,var(--primary),var(--secondary),var(--accent),var(--primary));
      background-size:200% 100%;opacity:0.9;
      animation:gradientShift 4s ease infinite;
    }
    @keyframes gradientShift{
      0%,100%{background-position:0% 50%}
      50%{background-position:100% 50%}
    }
    
    .login-container{
      display:flex;align-items:center;justify-content:center;
      min-height:100vh;padding:20px;position:relative;z-index:1;
    }
    .login-box{max-width:480px;width:100%;animation:heroEntry 1s ease-out}
    @keyframes heroEntry{
      0%{opacity:0;transform:translateY(50px) scale(0.9)}
      100%{opacity:1;transform:translateY(0) scale(1)}
    }
    
    .title{
      font-size:4.5rem;font-weight:900;
      background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 50%,var(--accent) 100%);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      background-clip:text;text-align:center;margin-bottom:12px;letter-spacing:-3px;
      animation:titleGlow 4s ease-in-out infinite;filter:drop-shadow(0 0 30px rgba(0,212,255,0.4));
    }
    @keyframes titleGlow{
      0%,100%{filter:drop-shadow(0 0 30px rgba(0,212,255,0.4)) brightness(1)}
      50%{filter:drop-shadow(0 0 50px rgba(124,58,237,0.6)) brightness(1.4)}
    }
    
    .subtitle{
      text-align:center;color:#94a3b8;font-size:1.25rem;margin-bottom:18px;
      font-weight:600;letter-spacing:1.5px;animation:subtitlePulse 3s ease-in-out infinite;
    }
    @keyframes subtitlePulse{
      0%,100%{opacity:0.8;transform:scale(1)}
      50%{opacity:1;transform:scale(1.02)}
    }
    
    .creator-badge{
      display:inline-block;
      background:linear-gradient(135deg,var(--secondary),var(--accent));
      color:white;padding:10px 28px;border-radius:50px;font-size:1rem;
      font-weight:bold;margin:0 auto 40px;
      box-shadow:0 6px 25px rgba(124,58,237,0.6);
      animation:badgeFloat 3s ease-in-out infinite;
      position:relative;overflow:hidden;cursor:pointer;
      transition:all 0.3s;
    }
    .creator-badge:hover{transform:scale(1.1) rotate(2deg);box-shadow:0 10px 40px rgba(255,0,110,0.8)}
    @keyframes badgeFloat{
      0%,100%{transform:translateY(0px)}
      50%{transform:translateY(-8px)}
    }
    
    .tabs{
      display:flex;margin-bottom:36px;border-bottom:3px solid #334155;
      border-radius:12px;overflow:hidden;background:rgba(30,41,59,0.5);
      box-shadow:inset 0 2px 8px rgba(0,0,0,0.3);
    }
    .tab{
      flex:1;padding:18px;text-align:center;font-weight:800;cursor:pointer;
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);position:relative;
      color:#94a3b8;font-size:1.05rem;letter-spacing:0.8px;
    }
    .tab::before{
      content:'';position:absolute;bottom:0;left:50%;width:0;height:5px;
      background:linear-gradient(90deg,var(--primary),var(--secondary));
      transform:translateX(-50%);transition:width 0.4s;border-radius:5px 5px 0 0;
    }
    .tab:hover{background:rgba(0,212,255,0.12);color:#cbd5e1;transform:translateY(-2px)}
    .tab.active{color:var(--primary);background:rgba(0,212,255,0.2)}
    .tab.active::before{width:100%}
    
    .input-group{margin-bottom:24px;position:relative}
    .input-box{
      background:rgba(30,41,59,0.8);
      border:3px solid rgba(100,116,139,0.4);
      border-radius:20px;padding:20px 24px;color:var(--text);width:100%;
      font-size:1.08rem;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
      backdrop-filter:blur(12px);font-weight:600;
    }
    .input-box:focus{
      outline:none;border-color:var(--primary);
      box-shadow:0 0 40px rgba(0,212,255,0.5),0 0 80px rgba(0,212,255,0.3),inset 0 2px 8px rgba(0,212,255,0.2);
      background:rgba(30,41,59,0.98);transform:translateY(-4px) scale(1.01);
    }
    .input-box::placeholder{color:#94a3b8;opacity:0.9}
    
    .captcha-container{text-align:center;margin-bottom:18px;position:relative}
    .captcha-img{
      max-width:100%;height:auto;border-radius:16px;margin-bottom:16px;display:inline-block;
      border:3px solid rgba(0,212,255,0.6);box-shadow:0 8px 25px rgba(0,212,255,0.3);
      transition:all 0.3s;animation:captchaGlow 2s ease-in-out infinite;cursor:pointer;
    }
    .captcha-img:hover{transform:scale(1.05) rotate(1deg);box-shadow:0 12px 40px rgba(0,212,255,0.5)}
    @keyframes captchaGlow{
      0%,100%{box-shadow:0 8px 25px rgba(0,212,255,0.3)}
      50%{box-shadow:0 12px 40px rgba(124,58,237,0.5)}
    }
    
    .btn-gradient{
      background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);
      color:white;padding:18px;border:none;border-radius:20px;font-weight:800;
      cursor:pointer;width:100%;font-size:1.2rem;
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
      box-shadow:0 8px 25px rgba(0,212,255,0.4);position:relative;overflow:hidden;
      letter-spacing:1px;text-transform:uppercase;
    }
    .btn-gradient::before{
      content:'';position:absolute;top:0;left:-150%;width:150%;height:100%;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
      transition:left 0.8s;
    }
    .btn-gradient:hover::before{left:150%}
    .btn-gradient:hover{
      transform:translateY(-6px) scale(1.03);
      box-shadow:0 16px 45px rgba(0,212,255,0.6),0 0 60px rgba(124,58,237,0.4);
    }
    .btn-gradient:active{transform:translateY(-2px) scale(0.98)}
    .btn-gradient:disabled{opacity:0.5;cursor:not-allowed;transform:none}
    
    .btn-refresh{
      background:linear-gradient(135deg,#06b6d4,#3b82f6);
      font-size:1.05rem;padding:16px;margin-bottom:18px;
    }
    
    .link{
      color:#60a5fa;font-size:1rem;text-decoration:underline;cursor:pointer;
      transition:all 0.3s;font-weight:700;position:relative;display:inline-block;
    }
    .link:hover{color:var(--primary);text-shadow:0 0 15px rgba(0,212,255,0.6)}
    
    .sidebar{
      position:fixed;left:0;top:0;width:320px;height:100vh;
      background:rgba(10,14,39,0.98);border-right:2px solid rgba(148,163,184,0.2);
      padding:40px 28px;overflow-y:auto;z-index:100;
      box-shadow:8px 0 35px rgba(0,0,0,0.6);
      backdrop-filter:blur(25px);transition:transform 0.3s;
    }
    .sidebar.hidden{transform:translateX(-100%)}
    .main-content{
      margin-left:320px;padding:40px;min-height:100vh;
      position:relative;z-index:1;transition:margin-left 0.3s;
    }
    .main-content.full-width{margin-left:0}
    
    .nav-item{
      padding:20px 24px;margin:14px 0;border-radius:18px;cursor:pointer;
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
      border-left:5px solid transparent;display:flex;align-items:center;
      gap:18px;font-size:17px;color:#cbd5e1;font-weight:700;
      position:relative;overflow:hidden;
    }
    .nav-item:hover{
      background:rgba(0,212,255,0.2);border-left-color:var(--primary);
      transform:translateX(10px);color:white;
      box-shadow:0 6px 20px rgba(0,212,255,0.3);
    }
    .nav-item.active{
      background:rgba(0,212,255,0.3);border-left-color:var(--primary);
      box-shadow:0 0 30px rgba(0,212,255,0.4);color:white;
    }
    
    .stat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:28px;margin-bottom:40px}
    .stat-card{
      background:rgba(30,41,59,0.9);border:3px solid rgba(0,212,255,0.4);
      border-radius:24px;padding:32px;text-align:center;
      box-shadow:0 8px 25px rgba(0,0,0,0.3);
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
      position:relative;overflow:hidden;
    }
    .stat-card:hover{
      transform:translateY(-10px) scale(1.02);border-color:var(--primary);
      box-shadow:0 16px 50px rgba(0,212,255,0.5);
    }
    .stat-value{
      font-size:3.5rem;font-weight:900;color:var(--primary);
      text-shadow:0 0 20px rgba(0,212,255,0.5);margin-bottom:10px;
      animation:statPulse 2s ease-in-out infinite;
    }
    @keyframes statPulse{
      0%,100%{transform:scale(1)}
      50%{transform:scale(1.05)}
    }
    .stat-label{font-size:1.05rem;color:#94a3b8;font-weight:700;letter-spacing:0.8px}
    
    .chat-container{max-height:600px;overflow-y:auto;padding:20px;margin-bottom:24px}
    .chat-msg{
      padding:20px 28px;border-radius:20px;margin:16px 0;
      animation:msgSlideIn 0.6s cubic-bezier(0.4,0,0.2,1);
      box-shadow:0 6px 20px rgba(0,0,0,0.3);max-width:82%;
      word-wrap:break-word;position:relative;
    }
    @keyframes msgSlideIn{
      0%{opacity:0;transform:translateY(30px) scale(0.9)}
      100%{opacity:1;transform:translateY(0) scale(1)}
    }
    .user-msg{
      background:linear-gradient(135deg,var(--primary),#0099cc);
      margin-left:auto;color:white;border-bottom-right-radius:6px;
    }
    .ai-msg{
      background:rgba(30,41,59,0.95);border:3px solid rgba(0,212,255,0.4);
      margin-right:auto;border-bottom-left-radius:6px;
    }
    .sys-msg{
      background:rgba(124,58,237,0.4);max-width:90%;margin:0 auto;
      text-align:center;font-size:15px;border:3px solid rgba(124,58,237,0.5);
      color:#e9d5ff;
    }
    
    .gradient-text{
      background:linear-gradient(135deg,var(--primary),var(--secondary),var(--accent));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      background-clip:text;font-weight:900;
    }
    
    .app-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:24px;margin:30px 0}
    .app-icon{
      background:rgba(30,41,59,0.9);border:3px solid rgba(100,116,139,0.4);
      border-radius:24px;padding:24px;text-align:center;cursor:pointer;
      transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
      position:relative;overflow:hidden;
    }
    .app-icon:hover{
      transform:translateY(-12px) scale(1.05);
      border-color:var(--primary);
      box-shadow:0 16px 40px rgba(0,212,255,0.5);
    }
    .app-icon i{font-size:3rem;margin-bottom:12px;
      background-image:linear-gradient(135deg,var(--primary),var(--secondary));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      background-clip:text;transition:transform 0.3s;
    }
    .app-icon:hover i{transform:scale(1.2) rotate(5deg)}
    .app-icon span{display:block;font-size:0.95rem;font-weight:700;color:#cbd5e1}
    
    .notification{
      position:fixed;top:24px;right:24px;
      background:rgba(15,23,42,0.97);backdrop-filter:blur(25px);
      border:3px solid var(--primary);border-radius:20px;
      padding:24px 32px;box-shadow:0 12px 40px rgba(0,0,0,0.5);
      z-index:1000;animation:notifSlideIn 0.6s cubic-bezier(0.4,0,0.2,1);
      min-width:320px;
    }
    @keyframes notifSlideIn{
      0%{opacity:0;transform:translateX(120px) scale(0.8)}
      100%{opacity:1;transform:translateX(0) scale(1)}
    }
    .notification.success{border-color:var(--success)}
    .notification.error{border-color:var(--danger)}
    .notification.warning{border-color:var(--warning)}
    
    .hidden{display:none!important}
    
    .menu-toggle{
      position:fixed;top:24px;left:24px;z-index:101;
      background:rgba(0,212,255,0.3);border:3px solid var(--primary);
      width:60px;height:60px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;font-size:1.5rem;color:white;
      transition:all 0.3s;box-shadow:0 6px 20px rgba(0,212,255,0.4);
    }
    .menu-toggle:hover{
      transform:scale(1.1) rotate(90deg);
      box-shadow:0 10px 30px rgba(0,212,255,0.6);
    }
    
    .typing-indicator{display:flex;gap:6px;padding:12px}
    .typing-dot{
      width:10px;height:10px;background:var(--primary);
      border-radius:50%;animation:typingBounce 1.4s ease-in-out infinite;
      box-shadow:0 0 10px rgba(0,212,255,0.6);
    }
    .typing-dot:nth-child(1){animation-delay:0s}
    .typing-dot:nth-child(2){animation-delay:0.2s}
    .typing-dot:nth-child(3){animation-delay:0.4s}
    @keyframes typingBounce{
      0%,60%,100%{transform:translateY(0)}
      30%{transform:translateY(-15px)}
    }
    
    .input-wrapper{
      position:relative;display:flex;gap:12px;align-items:center;
    }
    .send-btn{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      border:none;border-radius:50%;width:60px;height:60px;
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;transition:all 0.3s;
      box-shadow:0 6px 20px rgba(0,212,255,0.4);flex-shrink:0;
    }
    .send-btn:hover{
      transform:scale(1.1) rotate(15deg);
      box-shadow:0 10px 30px rgba(0,212,255,0.6);
    }
    .send-btn i{color:white;font-size:1.5rem}
    
    .feature-btn{
      background:rgba(30,41,59,0.9);border:3px solid rgba(0,212,255,0.4);
      border-radius:16px;padding:16px 24px;margin:8px;
      cursor:pointer;transition:all 0.3s;display:inline-block;
    }
    .feature-btn:hover{
      background:rgba(0,212,255,0.2);transform:translateY(-4px);
      box-shadow:0 8px 25px rgba(0,212,255,0.5);
    }
    
    .generated-image{
      max-width:100%;border-radius:20px;margin:20px 0;
      box-shadow:0 12px 40px rgba(0,212,255,0.4);
      animation:imageAppear 0.6s ease-out;
    }
    @keyframes imageAppear{
      0%{opacity:0;transform:scale(0.8)}
      100%{opacity:1;transform:scale(1)}
    }
    
    ::-webkit-scrollbar{width:12px}
    ::-webkit-scrollbar-track{background:rgba(30,41,59,0.6);border-radius:12px}
    ::-webkit-scrollbar-thumb{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      border-radius:12px;border:2px solid rgba(30,41,59,0.6);
    }
    ::-webkit-scrollbar-thumb:hover{
      background:linear-gradient(135deg,var(--secondary),var(--accent));
    }
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  <div class="menu-toggle hidden" id="menuToggle">
    <i class="fas fa-bars"></i>
  </div>
  <div id="app"></div>
  <div id="notifications"></div>

  <script>
    const API_BASE = 'http://127.0.0.1:8000';
    
    const appState = {
      currentView: 'login',
      currentTab: 'login',
      user: null,
      messages: [],
      stats: {queries: 0, sessions: 1, accuracy: 99.9, uptime: 100},
      captcha: null,
      captchaId: null,
      sidebarOpen: true,
      sessionId: null
    };

    function showNotification(message, type = 'success') {
      const container = document.getElementById('notifications');
      const notif = document.createElement('div');
      notif.className = `notification ${type}`;
      notif.innerHTML = `
        <div style="display:flex;align-items:center;gap:12px">
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}" 
             style="font-size:1.5rem;color:${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#f59e0b'}"></i>
          <span style="font-weight:600">${message}</span>
        </div>
      `;
      container.appendChild(notif);
      
      setTimeout(() => {
        notif.style.animation = 'notifSlideIn 0.6s reverse';
        setTimeout(() => notif.remove(), 600);
      }, 4000);
    }

    function sanitizeInput(input) {
      const div = document.createElement('div');
      div.textContent = input;
      return div.innerHTML;
    }

    function initParticles() {
      const container = document.getElementById('particles');
      container.innerHTML = '';
      for(let i = 0; i < 60; i++) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.style.left = Math.random() * 100 + '%';
        p.style.top = Math.random() * 100 + '%';
        p.style.animationDelay = Math.random() * 10 + 's';
        p.style.animationDuration = (10 + Math.random() * 5) + 's';
        container.appendChild(p);
      }
    }

    async function fetchCaptcha() {
      try {
        const response = await fetch(`${API_BASE}/captcha`);
        const data = await response.json();
        appState.captcha = data.image;
        appState.captchaId = data.id;
        return data.image;
      } catch(e) {
        console.error('Captcha fetch error:', e);
        showNotification('Backend not connected. Make sure Python server is running!', 'error');
        return null;
      }
    }

    function renderLogin() {
      return `
        <div class="login-container">
          <div class="login-box glass">
            <h1 class="title">JARVIS</h1>
            <p class="subtitle">Ultra Advanced AI v10.0</p>
            <div style="text-align:center;margin-bottom:30px">
              <div class="creator-badge">
                <i class="fas fa-code"></i> Created by AmmiAbbu
              </div>
            </div>
            
            <div class="tabs">
              <div class="tab ${appState.currentTab === 'login' ? 'active' : ''}" onclick="switchTab('login')">
                <i class="fas fa-sign-in-alt"></i> Login
              </div>
              <div class="tab ${appState.currentTab === 'signup' ? 'active' : ''}" onclick="switchTab('signup')">
                <i class="fas fa-user-plus"></i> Sign Up
              </div>
            </div>
            
            <div id="loginForm" class="${appState.currentTab === 'login' ? '' : 'hidden'}">
              <div class="input-group">
                <input type="text" id="loginUsername" class="input-box" placeholder="ðŸ‘¤ Username" required>
              </div>
              <div class="input-group">
                <input type="password" id="loginPassword" class="input-box" placeholder="ðŸ”’ Password" required>
              </div>
              
              <div class="captcha-container">
                <img id="loginCaptchaImg" src="data:image/png;base64,${appState.captcha || ''}" class="captcha-img" alt="CAPTCHA">
                <button onclick="refreshCaptcha()" class="btn-gradient btn-refresh">
                  <i class="fas fa-sync-alt"></i> Refresh CAPTCHA
                </button>
              </div>
              
              <div class="input-group">
                <input type="text" id="loginCaptcha" class="input-box" placeholder="ðŸ” Enter CAPTCHA" required>
              </div>
              
              <button onclick="handleLogin()" class="btn-gradient">
                <i class="fas fa-rocket"></i> Launch Jarvis
              </button>
              
              <p style="text-align:center;margin-top:20px">
                <span class="link" onclick="switchTab('signup')">Create new account</span>
              </p>
            </div>
            
            <div id="signupForm" class="${appState.currentTab === 'signup' ? '' : 'hidden'}">
              <div class="input-group">
                <input type="text" id="signupUsername" class="input-box" placeholder="ðŸ‘¤ Username" required>
              </div>
              <div class="input-group">
                <input type="password" id="signupPassword" class="input-box" placeholder="ðŸ”’ Password (min 6 chars)" required>
              </div>
              
              <div class="captcha-container">
                <img id="signupCaptchaImg" src="data:image/png;base64,${appState.captcha || ''}" class="captcha-img" alt="CAPTCHA">
                <button onclick="refreshCaptcha()" class="btn-gradient btn-refresh">
                  <i class="fas fa-sync-alt"></i> Refresh CAPTCHA
                </button>
              </div>
              
              <div class="input-group">
                <input type="text" id="signupCaptcha" class="input-box" placeholder="ðŸ” Enter CAPTCHA" required>
              </div>
              
              <button onclick="handleSignup()" class="btn-gradient">
                <i class="fas fa-user-plus"></i> Create Account
              </button>
              
              <p style="text-align:center;margin-top:20px">
                <span class="link" onclick="switchTab('login')">Already have an account?</span>
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderDashboard() {
      return `
        <div class="sidebar ${appState.sidebarOpen ? '' : 'hidden'}" id="sidebar">
          <div style="text-align:center;margin-bottom:40px
          <div style="text-align:center;margin-bottom:40px">
            <h2 class="gradient-text" style="font-size:2.5rem;margin-bottom:10px">JARVIS</h2>
            <p style="color:#94a3b8;font-size:0.95rem">Ultra Advanced AI v10.0</p>
          </div>
          
          <div class="nav-item active" onclick="showView('dashboard')">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
          </div>
          
          <div class="nav-item" onclick="showView('chat')">
            <i class="fas fa-comments"></i>
            <span>AI Chat</span>
          </div>
          
          <div class="nav-item" onclick="showView('solver')">
            <i class="fas fa-calculator"></i>
            <span>Problem Solver</span>
          </div>
          
          <div class="nav-item" onclick="showView('apps')">
            <i class="fas fa-th"></i>
            <span>Applications</span>
          </div>
          
          <div class="nav-item" onclick="showView('automation')">
            <i class="fas fa-robot"></i>
            <span>Automation</span>
          </div>
          
          <div class="nav-item" onclick="handleLogout()" style="margin-top:auto;background:rgba(239,68,68,0.2);border-left-color:#ef4444">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
          </div>
        </div>
        
        <div class="main-content ${appState.sidebarOpen ? '' : 'full-width'}">
          <div style="margin-bottom:40px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:20px">
            <div>
              <h1 class="gradient-text" style="font-size:3rem;margin-bottom:8px">Welcome, ${appState.user?.name || 'User'}!</h1>
              <p style="color:#94a3b8;font-size:1.2rem">Your AI-powered command center</p>
            </div>
            <div style="display:flex;gap:12px">
              <div style="background:rgba(0,212,255,0.2);padding:12px 24px;border-radius:16px;border:2px solid var(--primary)">
                <i class="fas fa-clock" style="color:var(--primary);margin-right:8px"></i>
                <span id="currentTime" style="font-weight:700">--:--:--</span>
              </div>
            </div>
          </div>
          
          <div class="stat-grid">
            <div class="stat-card">
              <div class="stat-value" id="statQueries"><i class="fas fa-search"></i> ${appState.stats.queries}</div>
              <div class="stat-label">Total Queries</div>
            </div>
            <div class="stat-card">
              <div class="stat-value"><i class="fas fa-bolt"></i> ${appState.stats.sessions}</div>
              <div class="stat-label">Active Sessions</div>
            </div>
            <div class="stat-card">
              <div class="stat-value"><i class="fas fa-chart-line"></i> ${appState.stats.accuracy}%</div>
              <div class="stat-label">Accuracy Rate</div>
            </div>
            <div class="stat-card">
              <div class="stat-value"><i class="fas fa-server"></i> ${appState.stats.uptime}%</div>
              <div class="stat-label">System Uptime</div>
            </div>
          </div>
          
          <div id="dynamicContent"></div>
        </div>
      `;
    }

    function renderChatView() {
      return `
        <div class="glass">
          <h2 class="gradient-text" style="font-size:2rem;margin-bottom:24px">
            <i class="fas fa-robot"></i> AI Chat Assistant
          </h2>
          
          <div style="margin-bottom:20px;display:flex;gap:12px;flex-wrap:wrap">
            <button class="feature-btn" onclick="quickPrompt('Generate image of a futuristic city')">
              <i class="fas fa-image"></i> Generate Image
            </button>
            <button class="feature-btn" onclick="quickPrompt('Generate meme about coding')">
              <i class="fas fa-laugh"></i> Generate Meme
            </button>
            <button class="feature-btn" onclick="quickPrompt('Realtime search: Latest AI news')">
              <i class="fas fa-search"></i> Web Search
            </button>
            <button class="feature-btn" onclick="quickPrompt('Debug code: python: print(Hello World)')">
              <i class="fas fa-bug"></i> Debug Code
            </button>
          </div>
          
          <div class="chat-container" id="chatContainer">
            ${appState.messages.length === 0 ? `
              <div class="sys-msg">
                <i class="fas fa-info-circle"></i> Start chatting with Jarvis AI - I can solve math, code, generate images & more!
              </div>
            ` : appState.messages.map(msg => `
              <div class="chat-msg ${msg.type}-msg">
                ${msg.type === 'ai' && msg.loading ? `
                  <div class="typing-indicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                  </div>
                ` : msg.image ? `
                  <img src="${msg.image}" class="generated-image" alt="Generated">
                  <p style="margin-top:12px">${sanitizeInput(msg.text)}</p>
                ` : sanitizeInput(msg.text)}
              </div>
            `).join('')}
          </div>
          
          <div class="input-wrapper">
            <input type="text" id="chatInput" class="input-box" 
                   placeholder="ðŸ’¬ Ask me anything... Math, Code, Images, Search..." 
                   style="flex:1;margin:0"
                   onkeypress="handleChatKeypress(event)">
            <button class="send-btn" onclick="sendMessage()">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
      `;
    }

    function renderSolverView() {
      return `
        <div class="glass">
          <h2 class="gradient-text" style="font-size:2rem;margin-bottom:24px">
            <i class="fas fa-calculator"></i> Problem Solver
          </h2>
          <p style="color:#94a3b8;margin-bottom:30px;font-size:1.1rem">
            Solve any Math, Physics, Chemistry, or Coding problem with 100% accuracy
          </p>
          
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px">
            <div class="feature-btn" onclick="quickSolve('Math')">
              <i class="fas fa-square-root-alt" style="font-size:2rem;margin-bottom:10px;display:block"></i>
              <h3 style="color:var(--primary);margin-bottom:8px">Mathematics</h3>
              <p style="color:#94a3b8;font-size:0.9rem">Algebra, Calculus, Statistics, etc.</p>
            </div>
            <div class="feature-btn" onclick="quickSolve('Physics')">
              <i class="fas fa-atom" style="font-size:2rem;margin-bottom:10px;display:block"></i>
              <h3 style="color:var(--primary);margin-bottom:8px">Physics</h3>
              <p style="color:#94a3b8;font-size:0.9rem">Mechanics, Thermodynamics, etc.</p>
            </div>
            <div class="feature-btn" onclick="quickSolve('Chemistry')">
              <i class="fas fa-flask" style="font-size:2rem;margin-bottom:10px;display:block"></i>
              <h3 style="color:var(--primary);margin-bottom:8px">Chemistry</h3>
              <p style="color:#94a3b8;font-size:0.9rem">Organic, Inorganic, etc.</p>
            </div>
            <div class="feature-btn" onclick="quickSolve('Code')">
              <i class="fas fa-code" style="font-size:2rem;margin-bottom:10px;display:block"></i>
              <h3 style="color:var(--primary);margin-bottom:8px">Programming</h3>
              <p style="color:#94a3b8;font-size:0.9rem">Debug & Optimize Code</p>
            </div>
          </div>
          
          <div class="input-group">
            <textarea id="solverInput" class="input-box" placeholder="Enter your problem here..." 
                      style="min-height:150px;resize:vertical"></textarea>
          </div>
          
          <button onclick="solveProblem()" class="btn-gradient">
            <i class="fas fa-magic"></i> Solve Problem
          </button>
          
          <div id="solverResult" style="margin-top:30px"></div>
        </div>
      `;
    }

    function renderAutomationView() {
      return `
        <div class="glass">
          <h2 class="gradient-text" style="font-size:2rem;margin-bottom:24px">
            <i class="fas fa-robot"></i> Task Automation
          </h2>
          
          <div style="margin-bottom:30px">
            <h3 style="color:var(--primary);margin-bottom:16px">Quick Actions</h3>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px">
              <button class="feature-btn" onclick="automateTask('open facebook')">
                <i class="fab fa-facebook"></i> Open Facebook
              </button>
              <button class="feature-btn" onclick="automateTask('open youtube')">
                <i class="fab fa-youtube"></i> Open YouTube
              </button>
              <button class="feature-btn" onclick="automateTask('open gmail')">
                <i class="fas fa-envelope"></i> Open Gmail
              </button>
              <button class="feature-btn" onclick="automateTask('open notepad')">
                <i class="fas fa-file-alt"></i> Open Notepad
              </button>
              <button class="feature-btn" onclick="automateTask('volume up')">
                <i class="fas fa-volume-up"></i> Volume Up
              </button>
              <button class="feature-btn" onclick="automateTask('volume down')">
                <i class="fas fa-volume-down"></i> Volume Down
              </button>
            </div>
          </div>
          
          <div class="input-group">
            <textarea id="automationInput" class="input-box" 
                      placeholder="Enter tasks separated by commas&#10;Example: open facebook, play song on youtube, volume up" 
                      style="min-height:120px"></textarea>
          </div>
          
          <button onclick="runAutomation()" class="btn-gradient">
            <i class="fas fa-play"></i> Run Automation
          </button>
          
          <div id="automationResults" style="margin-top:30px"></div>
        </div>
      `;
    }

    function renderAppsView() {
      const apps = [
        {icon: 'fa-instagram', name: 'Instagram'},
        {icon: 'fa-whatsapp', name: 'WhatsApp'},
        {icon: 'fa-facebook', name: 'Facebook'},
        {icon: 'fa-twitter', name: 'Twitter'},
        {icon: 'fa-youtube', name: 'YouTube'},
        {icon: 'fa-linkedin', name: 'LinkedIn'},
        {icon: 'fa-spotify', name: 'Spotify'},
        {icon: 'fa-github', name: 'GitHub'},
        {icon: 'fa-reddit', name: 'Reddit'},
        {icon: 'fa-discord', name: 'Discord'},
        {icon: 'fa-telegram', name: 'Telegram'},
        {icon: 'fa-tiktok', name: 'TikTok'},
        {icon: 'fa-rocket', name: 'SpaceX'},
        {icon: 'fa-amazon', name: 'Amazon'},
        {icon: 'fa-google', name: 'Google'},
        {icon: 'fa-apple', name: 'Apple'},
        {icon: 'fa-microsoft', name: 'Microsoft'},
        {icon: 'fa-netflix', name: 'Netflix'},
        {icon: 'fa-twitch', name: 'Twitch'},
        {icon: 'fa-dropbox', name: 'Dropbox'}
      ];
      
      return `
        <div class="glass">
          <h2 class="gradient-text" style="font-size:2rem;margin-bottom:24px">
            <i class="fas fa-th"></i> Application Hub
          </h2>
          <p style="color:#94a3b8;margin-bottom:30px;font-size:1.1rem">
            Launch any application with a single click
          </p>
          
          <div class="app-grid">
            ${apps.map(app => `
              <div class="app-icon" onclick="launchApp('${app.name}')">
                <i class="fab ${app.icon}"></i>
                <span>${app.name}</span>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    async function switchTab(tab) {
      appState.currentTab = tab;
      await fetchCaptcha();
      render();
    }

    async function refreshCaptcha() {
      const img = await fetchCaptcha();
      if(img) {
        const loginImg = document.getElementById('loginCaptchaImg');
        const signupImg = document.getElementById('signupCaptchaImg');
        if(loginImg) loginImg.src = `data:image/png;base64,${img}`;
        if(signupImg) signupImg.src = `data:image/png;base64,${img}`;
        showNotification('CAPTCHA refreshed!', 'success');
      }
    }

    async function handleLogin() {
      try {
        const username = document.getElementById('loginUsername')?.value.trim();
        const password = document.getElementById('loginPassword')?.value;
        const captcha = document.getElementById('loginCaptcha')?.value;
        
        if (!username || !password || !captcha) {
          showNotification('Please fill in all fields', 'error');
          return;
        }
        
        const response = await fetch(`${API_BASE}/login`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            username,
            password,
            captcha,
            captcha_id: appState.captchaId
          })
        });
        
        const data = await response.json();
        
        if(data.success) {
          appState.user = {name: username};
          appState.sessionId = data.session_id;
          appState.currentView = 'dashboard';
          appState.stats.sessions++;
          showNotification(data.message, 'success');
          render();
        } else {
          showNotification(data.message, 'error');
          await refreshCaptcha();
        }
      } catch (error) {
        console.error('Login error:', error);
        showNotification('âš ï¸ Backend not running! Start: python backend.py', 'error');
      }
    }

    async function handleSignup() {
      try {
        const username = document.getElementById('signupUsername')?.value.trim();
        const password = document.getElementById('signupPassword')?.value;
        const captcha = document.getElementById('signupCaptcha')?.value;
        
        if (!username || !password || !captcha) {
          showNotification('Please fill in all fields', 'error');
          return;
        }
        
        if(username.length < 3) {
          showNotification('Username must be at least 3 characters', 'error');
          return;
        }
        
        if(password.length < 6) {
          showNotification('Password must be at least 6 characters', 'error');
          return;
        }
        
        const response = await fetch(`${API_BASE}/register`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            username,
            password,
            captcha,
            captcha_id: appState.captchaId
          })
        });
        
        const data = await response.json();
        
        if(data.success) {
          showNotification(data.message, 'success');
          appState.currentTab = 'login';
          await fetchCaptcha();
          render();
        } else {
          showNotification(data.message, 'error');
          await refreshCaptcha();
        }
      } catch (error) {
        console.error('Signup error:', error);
        showNotification('âš ï¸ Backend not running! Start: python backend.py', 'error');
      }
    }

    async function handleLogout() {
      if (confirm('Are you sure you want to logout?')) {
        try {
          await fetch(`${API_BASE}/logout?session_id=${appState.sessionId}`, {method: 'POST'});
        } catch(e) {}
        
        appState.user = null;
        appState.sessionId = null;
        appState.currentView = 'login';
        appState.currentTab = 'login';
        appState.messages = [];
        showNotification('Logged out successfully', 'success');
        render();
      }
    }

    function showView(view) {
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      if(event && event.target) {
        event.target.closest('.nav-item')?.classList.add('active');
      }
      
      const content = document.getElementById('dynamicContent');
      if (!content) return;
      
      switch(view) {
        case 'chat':
          content.innerHTML = renderChatView();
          scrollToBottom();
          break;
        case 'solver':
          content.innerHTML = renderSolverView();
          break;
        case 'apps':
          content.innerHTML = renderAppsView();
          break;
        case 'automation':
          content.innerHTML = renderAutomationView();
          break;
        default:
          content.innerHTML = '<div class="glass"><h2 class="gradient-text" style="font-size:2rem;margin-bottom:16px"><i class="fas fa-rocket"></i> Dashboard Overview</h2><p style="color:#94a3b8;font-size:1.2rem;line-height:1.8">Welcome to Jarvis AI - Your ultra-advanced AI assistant. I can solve complex math, debug code, generate images, automate tasks, and much more!</p><div style="margin-top:30px;padding:24px;background:rgba(0,212,255,0.1);border-radius:20px;border:2px solid var(--primary)"><h3 style="color:var(--primary);margin-bottom:12px"><i class="fas fa-lightbulb"></i> Features</h3><ul style="color:#cbd5e1;line-height:2"><li>âœ“ AI Chat with Groq LLaMA 3.3</li><li>âœ“ Math & Code Problem Solver</li><li>âœ“ Image & Meme Generation</li><li>âœ“ Real-time Web Search</li><li>âœ“ Task Automation</li><li>âœ“ 25+ Apps Integration</li></ul></div></div>';
      }
    }

    async function sendMessage() {
      try {
        const input = document.getElementById('chatInput');
        if (!input) return;
        
        const message = input.value.trim();
        if (!message) {
          showNotification('Please enter a message', 'warning');
          return;
        }
        
        appState.messages.push({ type: 'user', text: message });
        appState.stats.queries++;
        input.value = '';
        
        appState.messages.push({ type: 'ai', text: '', loading: true });
        showView('chat');
        scrollToBottom();
        
        const response = await fetch(`${API_BASE}/chat`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            text: message,
            user: appState.user.name,
            session_id: appState.sessionId
          })
        });
        
        const data = await response.json();
        
        appState.messages.pop();
        
        if(data.error) {
          appState.messages.push({ type: 'ai', text: data.response });
        } else if(data.image) {
          appState.messages.push({ type: 'ai', text: data.response, image: data.image });
        } else if(data.meme) {
          appState.messages.push({ type: 'ai', text: data.response, image: data.meme });
        } else {
          appState.messages.push({ type: 'ai', text: data.response });
        }
        
        showView('chat');
        scrollToBottom();
        
        const statEl = document.getElementById('statQueries');
        if(statEl) {
          statEl.innerHTML = `<i class="fas fa-search"></i> ${appState.stats.queries}`;
        }
        
      } catch (error) {
        appState.messages.pop();
        appState.messages.push({ type: 'ai', text: 'âŒ Error: Backend not connected. Make sure Python server is running on port 8000!' });
        showView('chat');
        console.error('Send message error:', error);
      }
    }

    function handleChatKeypress(event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    }

    function quickPrompt(prompt) {
      const input = document.getElementById('chatInput');
      if (input) {
        input.value = prompt;
        input.focus();
        sendMessage();
      }
    }

    function quickSolve(type) {
      const input = document.getElementById('solverInput');
      if(input) {
        input.placeholder = `Enter your ${type} problem here...`;
        input.focus();
      }
    }

    async function solveProblem() {
      const input = document.getElementById('solverInput');
      const result = document.getElementById('solverResult');
      
      if(!input || !input.value.trim()) {
        showNotification('Please enter a problem to solve', 'warning');
        return;
      }
      
      result.innerHTML = '<div style="text-align:center;padding:40px"><div class="typing-indicator" style="justify-content:center"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div><p style="margin-top:20px;color:#94a3b8">Solving your problem...</p></div>';
      
      try {
        const response = await fetch(`${API_BASE}/chat`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            text: `Solve this problem step-by-step with detailed explanation: ${input.value}`,
            user: appState.user.name,
            session_id: appState.sessionId
          })
        });
        
        const data = await response.json();
        
        result.innerHTML = `
          <div class="glass" style="background:rgba(0,212,255,0.1);border-color:var(--primary)">
            <h3 style="color:var(--primary);margin-bottom:16px"><i class="fas fa-check-circle"></i> Solution</h3>
            <div style="color:#cbd5e1;line-height:1.8;white-space:pre-wrap">${sanitizeInput(data.response)}</div>
          </div>
        `;
        
        appState.stats.queries++;
      } catch(error) {
        result.innerHTML = `<div class="glass" style="border-color:var(--danger)"><p style="color:var(--danger)">âŒ Error connecting to backend. Make sure Python server is running!</p></div>`;
      }
    }

    async function runAutomation() {
      const input = document.getElementById('automationInput');
      const results = document.getElementById('automationResults');
      
      if(!input || !input.value.trim()) {
        showNotification('Please enter automation tasks', 'warning');
        return;
      }
      
      results.innerHTML = '<div style="text-align:center;padding:40px"><div class="typing-indicator" style="justify-content:center"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div><p style="margin-top:20px;color:#94a3b8">Running automation...</p></div>';
      
      try {
        const response = await fetch(`${API_BASE}/chat`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            text: `automate: ${input.value}`,
            user: appState.user.name,
            session_id: appState.sessionId
          })
        });
        
        const data = await response.json();
        
        if(data.tasks) {
          results.innerHTML = `
            <div class="glass">
              <h3 style="color:var(--primary);margin-bottom:20px"><i class="fas fa-tasks"></i> Automation Results</h3>
              ${data.tasks.map(task => `
                <div style="padding:16px;background:rgba(30,41,59,0.8);border-radius:12px;margin-bottom:12px;border-left:4px solid var(--primary)">
                  <div style="display:flex;justify-content:space-between;align-items:center">
                    <strong style="color:#cbd5e1">${task.name}</strong>
                    <span style="color:${task.progress === 100 ? 'var(--success)' : 'var(--warning)'}">${task.status}</span>
                  </div>
                </div>
              `).join('')}
            </div>
          `;
        } else {
          results.innerHTML = `<div class="glass"><p style="color:#cbd5e1">${data.response}</p></div>`;
        }
      } catch(error) {
        results.innerHTML = `<div class="glass" style="border-color:var(--danger)"><p style="color:var(--danger)">âŒ Error connecting to backend</p></div>`;
      }
    }

    async function automateTask(task) {
      showNotification(`Executing: ${task}`, 'success');
      const input = document.getElementById('automationInput');
      if(input) {
        input.value = task;
        await runAutomation();
      }
    }

    function scrollToBottom() {
      setTimeout(() => {
        const container = document.getElementById('chatContainer');
        if (container) {
          container.scrollTop = container.scrollHeight;
        }
      }, 100);
    }

    async function launchApp(appName) {
      showNotification(`Launching ${appName}...`, 'success');
      try {
        await fetch(`${API_BASE}/chat`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            text: `automate: open ${appName.toLowerCase()}`,
            user: appState.user.name,
            session_id: appState.sessionId
          })
        });
        setTimeout(() => {
          showNotification(`${appName} launched!`, 'success');
        }, 1000);
      } catch(e) {
        showNotification(`Error launching ${appName}`, 'error');
      }
    }

    function toggleSidebar() {
      appState.sidebarOpen = !appState.sidebarOpen;
      const sidebar = document.getElementById('sidebar');
      const mainContent = document.querySelector('.main-content');
      
      if (sidebar && mainContent) {
        sidebar.classList.toggle('hidden');
        mainContent.classList.toggle('full-width');
      }
    }

    function updateClock() {
      const clockElement = document.getElementById('currentTime');
      if (clockElement) {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        clockElement.textContent = `${hours}:${minutes}:${seconds}`;
      }
    }

    let clockInterval = null;

    async function render() {
      const app = document.getElementById('app');
      if (!app) return;
      
      try {
        if (appState.currentView === 'login') {
          if(!appState.captcha) {
            await fetchCaptcha();
          }
          app.innerHTML = renderLogin();
          document.getElementById('menuToggle')?.classList.add('hidden');
          if(clockInterval) {
            clearInterval(clockInterval);
            clockInterval = null;
          }
        } else {
          app.innerHTML = renderDashboard();
          document.getElementById('menuToggle')?.classList.remove('hidden');
          
          if(!clockInterval) {
            updateClock();
            clockInterval = setInterval(updateClock, 1000);
          }
          
          const content = document.getElementById('dynamicContent');
          if (content) {
            content.innerHTML = '<div class="glass"><h2 class="gradient-text" style="font-size:2rem;margin-bottom:16px"><i class="fas fa-rocket"></i> Dashboard Overview</h2><p style="color:#94a3b8;font-size:1.2rem;line-height:1.8">Welcome to Jarvis AI - Your ultra-advanced AI assistant capable of solving complex problems, generating images, debugging code, and automating tasks with 100% accuracy!</p><div style="margin-top:30px;padding:24px;background:rgba(0,212,255,0.1);border-radius:20px;border:2px solid var(--primary)"><h3 style="color:var(--primary);margin-bottom:12px"><i class="fas fa-lightbulb"></i> Quick Start</h3><ul style="color:#cbd5e1;line-height:2"><li>ðŸ’¬ <strong>AI Chat</strong> - Ask any question</li><li>ðŸ”¢ <strong>Problem Solver</strong> - Math, Physics, Chemistry</li><li>ðŸŽ¨ <strong>Image Generation</strong> - Create stunning visuals</li><li>ðŸ” <strong>Web Search</strong> - Real-time information</li><li>ðŸ¤– <strong>Automation</strong> - Control apps & system</li></ul></div></div>';
          }
        }
      } catch (error) {
        console.error('Render error:', error);
        app.innerHTML = '<div class="glass" style="margin:20px;text-align:center"><h2 style="color:#ef4444">An error occurred</h2><p style="color:#94a3b8;margin-top:16px">Please refresh the page</p></div>';
      }
    }

    document.addEventListener('DOMContentLoaded', async () => {
      try {
        initParticles();
        await render();
        
        const menuToggle = document.getElementById('menuToggle');
        if (menuToggle) {
          menuToggle.addEventListener('click', toggleSidebar);
        }
        
        document.addEventListener('keydown', (e) => {
          if (e.ctrlKey && e.key === 'k') {
            e.preventDefault();
            if (appState.currentView !== 'login') {
              showView('chat');
            }
          }
        });
        
      } catch (error) {
        console.error('Initialization error:', error);
      }
    });

    window.addEventListener('error', (e) => {
      console.error('Global error:', e.error);
    });
  </script>
</body>


 

